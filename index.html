<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Message for You</title>
    <style>
        /* --- CSS STYLES --- */
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Shadows+Into+Light&display=swap');

        :root {
            --bg-color: #121212;
            --text-main: #e0e0e0;
            --accent-pink: #ff007f;
            --accent-cyan: #00e5ff;
            --accent-yellow: #ffeb3b;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: 'Cinzel', serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
            text-align: center;
            flex-direction: column;
        }

        h1, h2, p {
            margin: 0.5em 0;
        }

        .hidden {
            display: none !important;
        }

        /* --- PHASE 1: INTRO --- */
        #intro-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            width: 100%;
            height: 100%;
        }

        .cryptic-text {
            font-size: 1.5rem;
            color: var(--accent-cyan);
            text-shadow: 0 0 10px var(--accent-cyan);
            margin-bottom: 2rem;
            font-family: 'Shadows Into Light', cursive;
            padding: 0 20px;
        }

        .emoji-container {
            font-size: 3rem;
            display: flex;
            gap: 20px;
            margin-top: 20px;
        }

        .running {
            animation: runAcross 4s linear infinite;
        }
        
        .acrobat {
            animation: bounce 2s ease-in-out infinite;
        }

        @keyframes runAcross {
            0% { transform: translateX(-100px); opacity: 0; }
            20% { opacity: 1; }
            80% { opacity: 1; }
            100% { transform: translateX(100px); opacity: 0; }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px) rotate(10deg); }
        }

        .start-hint {
            margin-top: 40px;
            font-size: 0.8rem;
            opacity: 0.6;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }

        /* --- PHASE 2: PUZZLE --- */
        #puzzle-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .puzzle-instructions {
            margin-bottom: 15px;
            color: var(--accent-pink);
            font-family: 'Shadows Into Light', cursive;
        }

        #puzzle-container {
            display: grid;
            grid-template-columns: repeat(3, 100px);
            grid-template-rows: repeat(3, 100px);
            gap: 2px;
            border: 2px solid var(--accent-cyan);
            background-color: #222;
        }

        .puzzle-piece {
            width: 100px;
            height: 100px;
            background-size: 300px 300px; /* 3 cols * 100px */
            cursor: grab;
            transition: transform 0.2s;
        }

        .puzzle-piece:active {
            cursor: grabbing;
            transform: scale(0.95);
            z-index: 10;
        }

        .puzzle-piece.dragging {
            opacity: 0.5;
        }

        /* --- PHASE 3: REVEAL --- */
        #reveal-screen {
            position: relative;
            width: 90%;
            max-width: 500px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .card-display {
            width: 100%;
            max-width: 300px;
            border: 3px solid var(--accent-yellow);
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(255, 235, 59, 0.3);
            margin-bottom: 20px;
            display: block;
        }

        .card-meaning {
            font-size: 1.1rem;
            color: #fff;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid var(--accent-pink);
        }

        .question {
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: var(--accent-pink);
            font-weight: bold;
        }

        .buttons {
            display: flex;
            gap: 20px;
            align-items: center;
            justify-content: center;
            height: 80px; /* Reserve space for growing button */
        }

        button {
            padding: 10px 20px;
            font-family: 'Cinzel', serif;
            font-size: 1rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        #yes-btn {
            background-color: var(--accent-cyan);
            color: #000;
            font-weight: bold;
        }

        #no-btn {
            background-color: transparent;
            border: 1px solid var(--accent-pink);
            color: var(--accent-pink);
        }

        #no-btn:hover {
            background-color: rgba(255, 0, 127, 0.1);
        }

        /* --- PHASE 4: FINAL --- */
        #final-screen {
            font-size: 2rem;
        }

        .sun-emoji {
            font-size: 8rem;
            animation: spinSun 10s linear infinite;
            display: block;
            margin-bottom: 20px;
        }

        @keyframes spinSun {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .final-msg {
            color: var(--accent-yellow);
            text-shadow: 0 0 10px var(--accent-yellow);
        }

    </style>
</head>
<body>

    <div id="intro-screen" onclick="startPuzzle()">
        <div class="cryptic-text">
            For the paths we run <br> and the balance we seek...
        </div>
        <div class="emoji-container">
            <span class="running">üèÉüèª</span>
            <span class="acrobat">ü§∏üèª‚Äç‚ôÇÔ∏è</span>
            <span class="running" style="animation-delay: 0.5s;">üèÉüèª‚Äç‚ôÄÔ∏è</span>
        </div>
        <div class="start-hint">(Touch to Begin)</div>
    </div>

    <div id="puzzle-screen" class="hidden">
        <div class="puzzle-instructions">Restore the vision... (Drag and drop tiles)</div>
        <div id="puzzle-container"></div>
    </div>

    <div id="reveal-screen" class="hidden">
        <img id="final-card-image" class="card-display" src="" alt="Oonagh's Card">
        <div class="card-meaning">
            <strong>Oonagh (Queen of Wands):</strong> <br>
            <span id="meaning-text">She represents creativity, passion, and determination. A bond that defies simple definition, full of fire and independent spirit.</span>
        </div>
        <div class="question">Will you be my Valentine?</div>
        <div class="buttons">
            <button id="yes-btn" onclick="sayYes()">Yes</button>
            <button id="no-btn" onclick="makeExcuses()">No</button>
        </div>
    </div>

    <div id="final-screen" class="hidden">
        <div class="sun-emoji">üåû</div>
        <div class="final-msg">The best is yet to come.</div>
    </div>

    <script>
        // --- CONFIGURATION ---
        
        // 1. PLACEHOLDER IMAGE: Replace this URL with the actual link to your Tarot Card image.
        // Note: The image should ideally be square or 3:4 ratio for the puzzle to look best.
        // Using a generic tarot back placeholder for now.
        const tarotImageSrc = "https://images.unsplash.com/photo-1620336655052-b68d97539d04?q=80&w=600&auto=format&fit=crop"; 
        
        // 2. TEXT CONFIGURATION
        const excuses = [
            "Not yet",
            "I'm not ready",
            "No, what will people think",
            "Maybe later",
            "It's complicated",
            "Ask me again"
        ];

        // --- PUZZLE LOGIC ---
        const puzzleContainer = document.getElementById('puzzle-container');
        let pieces = [];
        const rows = 3;
        const cols = 3;

        function startPuzzle() {
            document.getElementById('intro-screen').classList.add('hidden');
            document.getElementById('puzzle-screen').classList.remove('hidden');
            initPuzzle();
        }

        function initPuzzle() {
            puzzleContainer.innerHTML = '';
            pieces = [];
            
            // Create pieces
            for (let r = 0; r < rows; r++) {
                for (let c = 0; c < cols; c++) {
                    const piece = document.createElement('div');
                    piece.classList.add('puzzle-piece');
                    piece.style.backgroundImage = `url(${tarotImageSrc})`;
                    piece.style.backgroundPosition = `-${c * 100}px -${r * 100}px`;
                    piece.draggable = true;
                    
                    // Store correct position
                    piece.dataset.correctR = r;
                    piece.dataset.correctC = c;
                    
                    // Initial random position logic will handle actual placement
                    piece.dataset.currentR = r;
                    piece.dataset.currentC = c;

                    piece.addEventListener('dragstart', dragStart);
                    piece.addEventListener('dragover', dragOver);
                    piece.addEventListener('drop', drop);
                    
                    // For touch devices (basic support)
                    piece.addEventListener('click', touchSwap);

                    pieces.push(piece);
                }
            }

            // Shuffle pieces
            shuffleArray(pieces);
            pieces.forEach(p => puzzleContainer.appendChild(p));
        }

        let draggedPiece = null;
        let selectedPiece = null; // For touch click-to-swap

        function dragStart(e) {
            draggedPiece = this;
            this.classList.add('dragging');
        }

        function dragOver(e) {
            e.preventDefault(); // Necessary to allow dropping
        }

        function drop(e) {
            e.preventDefault();
            const targetPiece = this;
            
            if (draggedPiece && draggedPiece !== targetPiece) {
                swapPieces(draggedPiece, targetPiece);
            }
            draggedPiece.classList.remove('dragging');
            draggedPiece = null;
            checkWin();
        }

        // Simple click-to-swap for mobile usability
        function touchSwap() {
            if (!selectedPiece) {
                selectedPiece = this;
                this.style.opacity = '0.5';
            } else {
                swapPieces(selectedPiece, this);
                selectedPiece.style.opacity = '1';
                selectedPiece = null;
                checkWin();
            }
        }

        function swapPieces(nodeA, nodeB) {
            const parentA = nodeA.parentNode;
            const siblingA = nodeA.nextSibling === nodeB ? nodeA : nodeA.nextSibling;
            
            // Move nodeA to nodeB's position
            nodeB.parentNode.insertBefore(nodeA, nodeB);
            
            // Move nodeB to nodeA's original position
            parentA.insertBefore(nodeB, siblingA);
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function checkWin() {
            const currentPieces = Array.from(puzzleContainer.children);
            let isCorrect = true;
            
            // Calculate expected order
            // The pieces were created in order (0,0), (0,1), (0,2), etc.
            // We check if the piece at index i has correctR and correctC matching the grid index
            
            for (let i = 0; i < currentPieces.length; i++) {
                const piece = currentPieces[i];
                const targetR = parseInt(piece.dataset.correctR);
                const targetC = parseInt(piece.dataset.correctC);
                
                // Calculate actual row/col based on index i
                const actualR = Math.floor(i / cols);
                const actualC = i % cols;
                
                if (targetR !== actualR || targetC !== actualC) {
                    isCorrect = false;
                    break;
                }
            }

            if (isCorrect) {
                setTimeout(showReveal, 500);
            }
        }

        // --- REVEAL LOGIC ---
        function showReveal() {
            document.getElementById('puzzle-screen').classList.add('hidden');
            const revealScreen = document.getElementById('reveal-screen');
            revealScreen.classList.remove('hidden');
            
            // Set the full image
            document.getElementById('final-card-image').src = tarotImageSrc;
        }

        // --- INTERACTION LOGIC ---
        let noClickCount = 0;
        const yesBtn = document.getElementById('yes-btn');
        const noBtn = document.getElementById('no-btn');

        function makeExcuses() {
            // Change text
            const phrase = excuses[noClickCount % excuses.length];
            noBtn.innerText = phrase;
            
            // Increment logic
            noClickCount++;
            
            // Grow Yes button
            const currentSize = parseFloat(window.getComputedStyle(yesBtn).fontSize);
            yesBtn.style.fontSize = (currentSize + 5) + 'px';
            yesBtn.style.padding = (10 + noClickCount * 2) + 'px ' + (20 + noClickCount * 5) + 'px';
        }

        function sayYes() {
            document.getElementById('reveal-screen').classList.add('hidden');
            document.getElementById('final-screen').classList.remove('hidden');
        }
    </script>
</body>
</html>
